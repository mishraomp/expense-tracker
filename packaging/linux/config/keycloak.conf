# Keycloak Identity Server Configuration
# This file is sourced by the expense-tracker-keycloak systemd service

# ─────────────────────────────────────────────────────────────────────────────
# Database Configuration
# ─────────────────────────────────────────────────────────────────────────────
KC_DB=postgres
KC_DB_URL=jdbc:postgresql://localhost:5432/keycloak
KC_DB_USERNAME=keycloak
KC_DB_PASSWORD=CHANGE_ME

# ─────────────────────────────────────────────────────────────────────────────
# HTTP Configuration
# ─────────────────────────────────────────────────────────────────────────────
KC_HTTP_PORT=8080
KC_HTTP_ENABLED=true

# For production with HTTPS, configure these:
# KC_HTTPS_PORT=8443
# KC_HTTPS_CERTIFICATE_FILE=/path/to/cert.pem
# KC_HTTPS_CERTIFICATE_KEY_FILE=/path/to/key.pem

# ─────────────────────────────────────────────────────────────────────────────
# Hostname Configuration
# ─────────────────────────────────────────────────────────────────────────────
# Set to false for development/testing behind a reverse proxy
KC_HOSTNAME_STRICT=false
KC_HOSTNAME_STRICT_HTTPS=false

# For production, set the actual hostname:
# KC_HOSTNAME=auth.yourdomain.com

# ─────────────────────────────────────────────────────────────────────────────
# Proxy Configuration (when behind nginx)
# ─────────────────────────────────────────────────────────────────────────────
KC_PROXY_HEADERS=xforwarded

# ─────────────────────────────────────────────────────────────────────────────
# Health and Metrics
# ─────────────────────────────────────────────────────────────────────────────
KC_HEALTH_ENABLED=true
KC_METRICS_ENABLED=false

# ─────────────────────────────────────────────────────────────────────────────
# Initial Admin User (first startup only)
# ─────────────────────────────────────────────────────────────────────────────
# IMPORTANT: Change these after first login!
KC_BOOTSTRAP_ADMIN_USERNAME=admin
KC_BOOTSTRAP_ADMIN_PASSWORD=CHANGE_ME

# ─────────────────────────────────────────────────────────────────────────────
# Logging
# ─────────────────────────────────────────────────────────────────────────────
KC_LOG=console,file
KC_LOG_FILE=/var/log/expense-tracker/keycloak.log
KC_LOG_LEVEL=info
