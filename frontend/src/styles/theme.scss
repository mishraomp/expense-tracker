// Keep app-specific tweaks minimal to let Bootswatch Zephyr styles apply.
// Avoid overriding colors/typography/backgrounds defined by the theme.

// ============================================================================
// BASE STYLES
// ============================================================================

// Example spacing utility additions (safe with themes):
.content-section {
  margin-block: 1rem;
}

// Example utility to standardize card padding without color overrides:
.card-body {
  padding: 1rem 1.25rem;
}

// Guard against accidental horizontal overflow from rogue elements
body {
  overflow-x: hidden;
}

// Ensure media elements don't overflow their containers
img,
svg,
video,
canvas {
  max-width: 100%;
  height: auto;
}

// ============================================================================
// REUSABLE UTILITY CLASSES (replacing inline styles)
// ============================================================================

// Max-width utilities (using rem instead of px)
.mw-7 {
  max-width: 7.5rem; // ~120px
}

.mw-9 {
  max-width: 9.375rem; // ~150px
}

.mw-12 {
  max-width: 12.5rem; // ~200px
}

.mw-35 {
  max-width: 35rem; // 560px - for OAuth callback container
}

// Min-height utilities
.min-h-22 {
  min-height: 22rem; // 350px equivalent for charts
}

.min-h-31 {
  min-height: 31.25rem; // 500px for preview modal body
}

// Fixed dimensions for avatars and icons
.avatar-sm {
  width: 1.75rem;
  height: 1.75rem;
  font-size: 0.875rem;
}

.avatar-md {
  width: 2.5rem;
  height: 2.5rem;
}

.icon-sm {
  width: 1em;
  height: 1em;
  vertical-align: middle;
}

// Category badge styling
.category-badge {
  cursor: pointer;
  max-width: 7.5rem;
  border: none;

  &.category-badge--active {
    outline: 0.125rem solid var(--bs-primary);
  }
}

.category-badge-icon {
  font-size: 1.1em;
  line-height: 1;
}

// Table column width utilities (percentage-based for responsiveness)
.col-w-10 {
  width: 10%;
}

.col-w-15 {
  width: 15%;
}

.col-w-20 {
  width: 20%;
}

.col-w-25 {
  width: 25%;
}

.col-w-30 {
  width: 30%;
}

// Truncate cell utilities
.cell-truncate-sm {
  max-width: 6.25rem; // ~100px
}

.cell-truncate-md {
  max-width: 9.375rem; // ~150px
}

.cell-truncate-lg {
  max-width: 12.5rem; // ~200px
}

// Chart containers
.chart-container {
  width: 100%;
}

.chart-svg {
  width: 100%;
  height: auto;
}

// Modal backdrop
.modal-backdrop-custom {
  background-color: rgba(0, 0, 0, 0.5);
}

// Z-index utilities for modals
.z-modal {
  z-index: 1055;
}

.z-modal-backdrop {
  z-index: 1050;
}

// Progress bar container
.progress-track {
  width: 100%;
  background-color: var(--bs-gray-300);
  border-radius: 0.25rem;
  height: 1.25rem;
}

.progress-fill {
  height: 100%;
  border-radius: 0.25rem;
  transition: width 0.3s ease;
}

// Preview modal content sizing
.preview-iframe {
  width: 100%;
  height: 37.5rem; // ~600px
  border: none;
}

.preview-image {
  max-width: 100%;
  max-height: 37.5rem; // ~600px
}

// Import error list scrollable container
.error-list-scroll {
  max-height: 24rem;
}

// Hidden file inputs
.file-input-hidden {
  display: none;
}

// Cursor pointer utility
.cursor-pointer {
  cursor: pointer;
}

// Subcategory badge variant
.badge-subcategory {
  opacity: 0.75;
}

// Small text variant for subcategory manager
.text-xs {
  font-size: 0.75rem;
}

// Form controls in mapping suggestions
.mapping-input {
  margin-left: 0.625rem;
  padding: 0.3125rem;
  width: 12.5rem;
}

// Table with auto layout
.table-auto {
  table-layout: auto;
}

// ============================================================================
// REPORTS PAGE
// ============================================================================

.reports-page {
  font-size: 0.95rem;

  .card-title {
    font-size: 0.95rem;
  }

  h1.h3 {
    font-size: 1.25rem;
  }

  @media (min-height: 50rem) {
    .card-body {
      padding: 0.6rem 0.75rem;
    }
    .card-title {
      margin-bottom: 0.25rem;
    }
  }
}

// ============================================================================
// MODAL ANIMATIONS
// ============================================================================

.modal.modal-slide .modal-dialog {
  transition: transform 250ms ease-out;
}

@media (max-width: 36rem) {
  .modal.modal-slide .modal-dialog {
    transform: translateY(100%);
    margin: 0;
  }

  .modal.modal-slide.show .modal-dialog {
    transform: translateY(0);
  }
}

@media (max-width: 47.9375rem) and (orientation: landscape) {
  .modal.modal-slide .modal-dialog {
    transform: translateX(100%);
    margin: 0;
  }

  .modal.modal-slide.show .modal-dialog {
    transform: translateX(0);
  }
}

// ============================================================================
// RESPONSIVE TABLE IMPROVEMENTS
// ============================================================================

// On smaller screens, allow text wrapping in table cells
@media (max-width: 48rem) {
  .table-responsive-wrap {
    th,
    td {
      white-space: normal;
      word-break: break-word;
    }
  }
}

// Inline filter row in table header
.table-filter-row {
  th {
    vertical-align: top;
    font-weight: normal;
    padding: 0.4rem 0.35rem;
  }

  .form-select,
  .form-control {
    min-width: 3rem;
    font-size: 0.75rem;
    padding: 0.2rem 0.35rem;
  }

  // Date inputs compact
  input[type='date'] {
    min-width: 5.5rem;
    padding: 0.15rem 0.2rem;
  }

  // Compact filter inputs on small screens
  @media (max-width: 62rem) {
    .form-select,
    .form-control {
      font-size: 0.7rem;
      padding: 0.2rem 0.3rem;
    }

    input[type='date'] {
      min-width: 5rem;
      padding: 0.15rem 0.15rem;
    }
  }

  @media (max-width: 48rem) {
    .form-select,
    .form-control {
      font-size: 0.65rem;
      padding: 0.15rem 0.2rem;
    }

    input[type='date'] {
      min-width: 4.5rem;
    }
  }
}

// Full-width tables on all screen sizes
.table {
  width: 100%;
}

// Expenses table optimizations
.expenses-table {
  table-layout: fixed;

  // Distribute columns proportionally (9 columns total)
  th,
  td {
    padding: 0.35rem 0.4rem;
    overflow: hidden;
    text-overflow: ellipsis;

    // Allow dropdowns to overflow in filter cells
    &.filter-cell-overflow {
      overflow: visible;
    }
    
    &:nth-child(1) {
      // Date
      width: 14%;
      min-width: 11rem;
    }
    &:nth-child(2) {
      // Amount
      width: 7%;
      min-width: 4.5rem;
    }
    &:nth-child(3) {
      // Category
      width: 9%;
      min-width: 5.5rem;
    }
    &:nth-child(4) {
      // Subcategory
      width: 9%;
      min-width: 5.5rem;
    }
    &:nth-child(5) {
      // Description
      width: 13%;
      min-width: 7rem;
      max-width: 10rem;
    }
    &:nth-child(6) {
      // Att
      width: 4%;
      min-width: 3rem;
      text-align: center;
    }
    &:nth-child(7) {
      // Items
      width: 7%;
      min-width: 4.5rem;
      text-align: center;
    }
    &:nth-child(8) {
      // Tags
      width: 12%;
      min-width: 8rem;
    }
    &:nth-child(9) {
      // Actions
      width: 5%;
      min-width: 3.5rem;
      text-align: center;
    }
  }

  // On medium screens, hide less important columns
  @media (max-width: 62rem) {
    th,
    td {
      &:nth-child(6) {
        // Hide Att column
        display: none;
      }
    }
  }

  // On small screens, hide more columns
  @media (max-width: 48rem) {
    th,
    td {
      &:nth-child(5),
      &:nth-child(6) {
        // Hide Description and Att
        display: none;
      }
    }
  }
}

// Item list tables responsive behavior
.expense-item-table {
  th,
  td {
    &.col-name {
      width: 30%;
    }
    &.col-amount {
      width: 15%;
    }
    &.col-category {
      width: 20%;
    }
    &.col-notes {
      width: 25%;
    }
    &.col-actions {
      width: 10%;
    }
  }

  @media (max-width: 36rem) {
    th,
    td {
      &.col-notes {
        display: none;
      }
    }
  }
}

// ============================================================================
// TAG BADGE STYLES
// ============================================================================

.tag-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
  border-radius: 1rem;
  font-weight: 500;
  white-space: nowrap;
  transition: opacity 0.15s ease-in-out;

  &--sm {
    padding: 0.125rem 0.5rem;
    font-size: 0.75rem;
    line-height: 1.25;
  }

  &--md {
    padding: 0.25rem 0.625rem;
    font-size: 0.875rem;
    line-height: 1.35;
  }

  &--clickable {
    cursor: pointer;

    &:hover {
      opacity: 0.85;
    }

    &:focus-visible {
      outline: 0.125rem solid var(--bs-primary);
      outline-offset: 0.0625rem;
    }
  }

  &__remove {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1em;
    height: 1em;
    padding: 0;
    margin-left: 0.125rem;
    border: none;
    background: transparent;
    color: inherit;
    font-size: 1.1em;
    font-weight: bold;
    line-height: 1;
    cursor: pointer;
    opacity: 0.7;
    border-radius: 50%;

    &:hover {
      opacity: 1;
      background-color: rgba(0, 0, 0, 0.15);
    }

    &:focus-visible {
      outline: 0.0625rem solid currentColor;
    }
  }
}

// Tag list container (used in tables and forms)
.tag-list {
  display: flex;
  flex-wrap: wrap;
  gap: 0.25rem;
  margin: 0;
  padding: 0;
  list-style: none;
}

// Tag selector dropdown styles
.tag-selector {
  position: relative;

  &__trigger {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.5rem;
    border: 0.0625rem solid var(--bs-border-color);
    border-radius: 0.375rem;
    background: var(--bs-body-bg);
    cursor: pointer;
    min-height: 2.375rem;

    &:hover {
      border-color: var(--bs-primary);
    }

    &:focus-within {
      border-color: var(--bs-primary);
      box-shadow: 0 0 0 0.125rem rgba(var(--bs-primary-rgb), 0.25);
    }
  }

  &__dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    z-index: 1050;
    margin-top: 0.25rem;
    padding: 0.5rem;
    background: var(--bs-body-bg);
    border: 0.0625rem solid var(--bs-border-color);
    border-radius: 0.375rem;
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.15);
    max-height: 15rem;
    overflow-y: auto;
  }

  &__option {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.375rem 0.5rem;
    border-radius: 0.25rem;
    cursor: pointer;

    &:hover {
      background-color: var(--bs-tertiary-bg);
    }

    &--selected {
      background-color: rgba(var(--bs-primary-rgb), 0.1);
    }
  }

  &__create {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.375rem 0.5rem;
    border-top: 0.0625rem solid var(--bs-border-color);
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    color: var(--bs-primary);
    cursor: pointer;

    &:hover {
      text-decoration: underline;
    }
  }
}

// ============================================================================
// TAG FILTER SELECT (compact multi-select for table filter rows)
// ============================================================================

.tag-filter-select {
  position: relative;
  width: 100%;

  &__trigger {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.25rem;
    padding: 0.2rem 0.35rem;
    border: 0.0625rem solid var(--bs-border-color);
    border-radius: 0.25rem;
    background: var(--bs-body-bg);
    cursor: pointer;
    min-height: 1.75rem;
    font-size: 0.75rem;

    &:hover {
      border-color: var(--bs-primary);
    }

    &--open {
      border-color: var(--bs-primary);
      box-shadow: 0 0 0 0.125rem rgba(var(--bs-primary-rgb), 0.25);
    }

    &--disabled {
      opacity: 0.65;
      cursor: not-allowed;
      background-color: var(--bs-tertiary-bg);
    }
  }

  &__placeholder {
    color: var(--bs-secondary-color);
    font-size: 0.7rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  &__selected {
    display: flex;
    align-items: center;
    gap: 0.2rem;
    flex: 1;
    min-width: 0;
    overflow: hidden;

    .tag-badge {
      max-width: 4.5rem;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  }

  &__more {
    font-size: 0.65rem;
    color: var(--bs-secondary-color);
    white-space: nowrap;
  }

  &__actions {
    display: flex;
    align-items: center;
    gap: 0.15rem;
    flex-shrink: 0;
  }

  &__clear {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 1rem;
    height: 1rem;
    padding: 0;
    border: none;
    background: transparent;
    color: var(--bs-secondary-color);
    font-size: 0.875rem;
    font-weight: bold;
    cursor: pointer;
    border-radius: 50%;

    &:hover {
      color: var(--bs-danger);
      background-color: rgba(var(--bs-danger-rgb), 0.1);
    }
  }

  &__arrow {
    font-size: 0.5rem;
    color: var(--bs-secondary-color);
  }

  &__dropdown {
    z-index: 1060;
    background: var(--bs-body-bg);
    border: 0.0625rem solid var(--bs-border-color);
    border-radius: 0.375rem;
    box-shadow: 0 0.25rem 0.75rem rgba(0, 0, 0, 0.2);
  }

  &__pills {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    margin-top: 0.35rem;

    .tag-badge {
      max-width: 100%;
    }
  }

  &__search {
    padding: 0.375rem;
    border-bottom: 0.0625rem solid var(--bs-border-color);

    .form-control {
      font-size: 0.75rem;
    }
  }

  &__options {
    max-height: 10rem;
    overflow-y: auto;
    padding: 0.25rem;
  }

  &__option {
    display: flex;
    align-items: center;
    padding: 0.3rem 0.4rem;
    border-radius: 0.25rem;
    cursor: pointer;

    &:hover {
      background-color: var(--bs-tertiary-bg);
    }
  }

  &__empty {
    padding: 0.5rem;
    text-align: center;
    color: var(--bs-secondary-color);
    font-size: 0.75rem;
  }

  &__footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.375rem 0.5rem;
    border-top: 0.0625rem solid var(--bs-border-color);
    background-color: var(--bs-tertiary-bg);
  }
}

